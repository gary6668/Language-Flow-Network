# Language-Flow-Network

> Maybe I want Change

è¯­è¨€å…¶å®žæ˜¯æƒ…ç»ªçš„æŠ•å½±ã€‚  
æ¯ä¸ªå¥å­èƒŒåŽçš„ token éƒ½æºå¸¦ç€æƒ…ç»ªçŠ¶æ€ã€‚  
è¿™ç§æƒ…ç»ªä¸ä¼šåœ¨è¯ä¸Žè¯ä¹‹é—´çªç„¶æ–­å¼€ï¼Œè€Œæ˜¯è¿žç»­æ¼”åŒ–ã€‚  
å› æ­¤ï¼Œè¯­è¨€çš„ç”Ÿæˆä¸æ˜¯ä¸€è¿žä¸²ç›¸äº’ç‹¬ç«‹çš„æ¦‚çŽ‡äº‹ä»¶ï¼Œ  
è€Œæ˜¯ä¸€æ¡åœ¨æ—¶é—´ä¸­æµåŠ¨ã€å¸¦æœ‰ä¸å¯é€†æ€§çš„è½¨è¿¹ã€‚

---

## ðŸ§© 1. æ ¸å¿ƒè§‚ç‚¹

Language Flow Networkï¼ˆLFNï¼‰æå‡ºï¼š  
è‡ªç„¶è¯­è¨€å¹¶éžç‹¬ç«‹æ ·æœ¬çš„é›†åˆï¼Œè€Œæ˜¯ä¸€ç§éšæ—¶é—´è¿žç»­æ¼”åŒ–çš„å¯è§‚æµ‹è¿‡ç¨‹ã€‚  

æˆ‘ä»¬ä½¿ç”¨ InfoNCEï¼ˆäº’ä¿¡æ¯çš„å¯è®¡ç®—ä»£ç†ï¼‰æ¥åº¦é‡ï¼š  
è¿‡åŽ»çª—å£çš„å¥å‘é‡èƒ½å¦é¢„æµ‹å½“å‰å¥å‘é‡ã€‚  

- Originalï¼šä¿æŒåŽŸå§‹é¡ºåº  
- Shuffleï¼šæ‰“ä¹±é¡ºåºä½œä¸ºå¯¹ç…§  

è‹¥ Original çš„ InfoNCE æ›´ä½Žï¼ˆäº’ä¿¡æ¯æ›´é«˜ï¼‰ï¼Œ  
è¯´æ˜Žè¯­è¨€åœ¨å‘é‡ç©ºé—´ä¸­å­˜åœ¨æ—¶é—´é»æ€§ä¸Žæƒ…ç»ªè¿žç»­æ€§ã€‚

---

## ðŸ“‚ 2. ä»“åº“ç»“æž„

Language-Flow-Network/
â”œâ”€â”€ datasets/
â”‚   â””â”€â”€ aclImdb/                      # å¯é€‰ï¼šæœ¬åœ° IMDb æ•°æ®ï¼ˆä¸æäº¤åˆ°ä»“åº“ï¼‰
â”‚
â”œâ”€â”€ lang-dynamics/
â”‚   â”œâ”€â”€ data_cfg.yaml
â”‚   â”œâ”€â”€ run_embed.py                  # å¥å‘é‡æå–ï¼ˆæ”¯æŒç¦»çº¿ DistilBERT æˆ–éšæœºæŠ•å½±ï¼‰
â”‚   â”œâ”€â”€ run_mi.py                     # InfoNCE è®¡ç®—ä¸Žæ—¶é—´å¯¹ç…§
â”‚   â””â”€â”€ models/
â”‚       â”œâ”€â”€ distilbert-base-uncased/  # å¯é€‰ï¼šæœ¬åœ° HF æ¨¡åž‹æ–‡ä»¶å¤¹
â”‚       â”œâ”€â”€ encoders.py
â”‚       â””â”€â”€ mine.py
â”‚
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ imdb_local/
â”‚   â””â”€â”€ dailydialog/
â”‚
â”œâ”€â”€ utils/
â””â”€â”€ run_all.sh                        # ä¸€é”®è¿è¡Œè„šæœ¬

---

## âš™ï¸ 3. å¿«é€Ÿè¿è¡Œ

conda create -n langdyn python=3.10 -y  
conda activate langdyn  
pip install -r requirements.txt  

# Step 1. ç”Ÿæˆå¥å‘é‡  
python lang-dynamics/run_embed.py  

# Step 2. è®¡ç®—äº’ä¿¡æ¯  
python -m lang-dynamics.run_mi --emb outputs/imdb_local/emb_local.npz --window 3 --mode original --out outputs/imdb_local/mi_original.txt  

æˆ–ç›´æŽ¥è¿è¡Œï¼š  
bash run_all.sh  

---

## ðŸ“Š 4. å®žéªŒç»“æžœ

| æ¨¡å¼ | å¹³å‡ InfoNCEï¼ˆè¶Šä½Žè¶Šç›¸å…³ï¼‰ | ç»“è®º |
|------|-----------------------------|------|
| Original | 1.5792 | åºåˆ—ä¿æŒæ—¶é—´ç›¸å…³æ€§ |
| Shuffle  | 1.5053 | æ‰“ä¹±å‰Šå¼±æ—¶é—´ç»“æž„ |

å½“è¯­è¨€çš„æ—¶é—´ç»“æž„è¢«ç ´åæ—¶ï¼Œäº’ä¿¡æ¯ä¸‹é™ã€‚  
è¯´æ˜Žè¯­è¨€ä¸æ˜¯ç‹¬ç«‹çš„éšæœºè¿‡ç¨‹ï¼Œè€Œæ˜¯ä¸€ç§å…·æœ‰å¯é‡åŒ–æ—¶é—´åŠ¨åŠ›æ€§çš„è¿žç»­ç³»ç»Ÿã€‚

---

## ðŸ§  5. ç†è®ºå¯ç¤º

- è¯­è¨€æ˜¯ä¸€ç§æ—¶é—´ä¸Šçš„è¿žç»­æµï¼Œè€Œéžç¦»æ•£äº‹ä»¶çš„é›†åˆã€‚  
- æƒ…ç»ªåœ¨è¯­ä¹‰ç©ºé—´ä¸­æ˜¯å¹³æ»‘æ¼”åŒ–çš„ï¼Œä¸æ˜¯çž¬é—´è·³å˜çš„ã€‚  
- InfoNCE å¯ä½œä¸ºè¯­è¨€åŠ¨åŠ›å­¦çš„åº¦é‡å·¥å…·ï¼Œç”¨äºŽåˆ†æžæ—¶é—´ä¸€è‡´æ€§ã€‚  
- è¯­è¨€æ¨¡åž‹å¯æ‰©å±•è‡³â€œæ—¶é—´åŠ¨åŠ›ä¸€è‡´æ€§çº¦æŸâ€ï¼ˆTemporal Coherence Constraintï¼‰æ–¹å‘ã€‚

---

## ðŸ§¾ 6. å¼•ç”¨

@misc{gu2025languageflownetwork,  
  author = {Gu, Longhao},  
  title  = {Language Flow Network: Quantifying Temporal Mutual Information in Language Dynamics},  
  year   = {2025},  
  url    = {https://github.com/yourusername/Language-Flow-Network}  
}

---

> å¦‚æžœ Transformer æ˜¯ç¬¦å·çš„é€»è¾‘æœºå™¨ï¼Œ  
> é‚£ä¹ˆ Language Flow Network æ˜¯æƒ…ç»ªçš„æ—¶é—´æœºå™¨ã€‚
